var rocket88=rocket88||{};rocket88.version="0.1";rocket88.authors="Patrick Pietens";var radiansToDegrees=function(e){return e*180/Math.PI},degreesToRadians=function(e){return Math.PI/180*e};window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}();window.delegate=function(e,t){return function(){return t.apply(e,arguments)}};window.getVendorPrefix=function(){var e=/^(Moz|Webkit|Khtml|O|ms|Icab)(?=[A-Z])/,t=document.getElementsByTagName("script")[0];for(var n in t.style)if(e.test(n))return n.match(e)[0];return"WebkitOpacity"in t.style?"Webkit":"KhtmlOpacity"in t.style?"Khtml":""};(function(){var e=!1,t=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;this.Class=function(){};Class.extend=function(n){function o(){!e&&this.init&&this.init.apply(this,arguments)}var r=this.prototype;e=!0;var i=new this;e=!1;for(var s in n)i[s]=typeof n[s]=="function"&&typeof r[s]=="function"&&t.test(n[s])?function(e,t){return function(){var n=this._super;this._super=r[e];var i=t.apply(this,arguments);this._super=n;return i}}(s,n[s]):n[s];o.prototype=i;o.prototype.constructor=o;o.extend=arguments.callee;return o}})();rocket88.EventDispatcher=Class.extend({init:function(e){this._events={}},addListener:function(e,t){if(!e){console.assert(!Rocket88.showErrors,"Required parameter 'event' is missing");return}if(!t){console.assert(!Rocket88.showErrors,"Required parameter 'listener' is missing");return}var n=this._events,r=n[e]=n[e]||[];r.push(t)},removeListener:function(e,t){var n=this._events[e],r=n.length;while(--r>-1){var i=n[r];n==t&&n.splice(r,1)}},removeAllListeners:function(){this._events={}},dispatch:function(e){var t=this._events[e];if(t){var n=Array.prototype.slice.call(arguments,1);for(var r=0,i=t.length;r<i;r++){var s=t[r];s.apply(null,n)}}},dispose:function(){this._events=null}});rocket88.LinkedList=Class.extend({init:function(){this._head=null;this._tail=null;this._size=0;this.__defineGetter__("head",function(){return this._head});this.__defineGetter__("tail",function(){return this._tail});this.__defineGetter__("size",function(){return this._size})},add:function(e){this._size++;var t=new LinkedListNode(e,this);if(this._head){t.prev=this._tail;this._tail.next=t;this._tail=t}else{this._head=t;this._tail=t}return t},insertBefore:function(e,t){this._size++;var n=new LinkedListNode(e,this);if(t==this._head){n.next=this._head;this._head.prev=n;this._head=n;return n}var r=t.prev;r.next=n;t.prev=n;n.prev=r;n.next=t;return n},insertAfter:function(e,t){this._size++;var n=new LinkedListNode(e,this);if(t==this._tail){this._tail.next=n;this._tail=n;return n}n.next=t.next;n.prev=t;t.next=n;return n},remove:function(e){if(e==this._head){this.shift();return!0}if(e==this._tail){this.pop();return!0}var t=e.next,n=e.prev;t.prev=n;n.next=t;this._size--;e.dispose();return e},shift:function(){if(this._head){this._size--;if(this._head==this._tail){this._head=null;this._tail=null}else{var e=this._head.next;e.prev=null;this._head=e}}return this._head},pop:function(){if(this._tail){this._size--;if(this._head==this._tail){this._head=null;this._tail=null}else{var e=this._tail.prev;e.next=null;this._tail=e}}return this._tail},swap:function(e,t){var n=e.data;e.data=t.data;t.data=n},sort:function(e){var t=this._extensionList.head();while(t){var n=t.data;n.autoDestroy()&&n.destroy();t=t.next}},contains:function(e){var t=this._head;while(t){if(t.data==e)return!0;t=t.next}return!1},empty:function(){var e=this.head;while(e){var t=e.next;this.remove(e);e=t}},nodeOf:function(e){var t=this._head;while(t){if(t.data==e)return t;t=t.next}return null},toArray:function(){var e=[],t=this._head;while(t){e.push(t.data);t=t.next}return e},empty:function(){}});var LinkedListNode=Class.extend({init:function(e,t){this._list=t;this.data=e;this.next=null;this.prev=null;this.__defineGetter__("list",function(){return this._list})},remove:function(){this._list.remove(this)},dispose:function(){this._list=null;this.data=null;this.next=null;this.prev=null}});rocket88.AssetLoader=Class.extend({init:function(){if(rocket88.assetLoader)throw ReferenceError("Houston, we have a problem. AssetLoader is a singleton class. Use rocket88.assetLoader to get a reference.");this._currentIndex=0;this._queue=new Array;this._running=!1;this._imageExtensions=["png","jpg","jpeg","gif"];this._textExtensions=["txt","xml","json","php"];this._soundExtensions=["wav","mp3","ogg"];this.addToAssetStore=!0},addAsset:function(e){if(this._isRunning){console.warn("");return}this._queue.push(e)},addAssets:function(e){this._queue=this._queue.concat(e)},downloadAll:function(e){if(this._running)return;this._currentIndex=-1;this._running=!0;this._totalSize=e;this.downloadNext()},downloadNext:function(){this._currentIndex++;var e=this._queue[this._currentIndex],t=e.split(".").pop().toLowerCase();this._textExtensions.indexOf(t)>-1?this.downloadTextFile(e):this._imageExtensions.indexOf(t)>-1?this.downloadImage(e):this._soundExtensions.indexOf(t)>-1&&this.downloadAudio(e)},downloadTextFile:function(e){var t=this,n=new XMLHttpRequest;n.onprogress=function(e){};n.onreadystatechange=function(r){if(n.readyState==4&&n.status==200){var i=e.split(".").pop().toLowerCase(),s=undefined;switch(i){case"json":s=JSON.parse(this.response);break;default:s=this.response}t.addToAssetStore&&rocket88.assetStore.addAsset(s,e);t.onAsset(e,s,this.response);if(t._currentIndex==t._queue.length-1){this._running=!1;t.onComplete();return}t.downloadNext()}};n.open("GET",e,!0);n.send()},downloadImage:function(e){var t=this,n=new Image;n.onprogress=function(e){};n.onload=function(n){t.addToAssetStore&&rocket88.assetStore.addAsset(this,e);t.onAsset(e,this,undefined);if(t._currentIndex==t._queue.length-1){this._running=!1;t.onComplete();return}t.downloadNext()};n.src=e},downloadAudio:function(e){var t=document.createElement("audio");if(t.play&&t.canPlayType("audio/mpeg")){this.song=new Audio(e);this.song.load()}},onProgress:function(e){},onAsset:function(e,t,n){},onComplete:function(){},dispose:function(){this._super();this._assetStore=null}});rocket88.assetLoader=new rocket88.AssetLoader;rocket88.AssetStore=Class.extend({init:function(){if(rocket88.assetStore)throw ReferenceError("Houston, we have a problem. AssetStore is a singleton class. Use rocket88.assetStore method to get a reference.");rocket88.AssetStore.instance=this;this._disposed=!1;this._assets=new Object;this.__defineGetter__("isDisposed",function(){return this._disposed});this.__defineGetter__("assets",function(){var e=new Array;for(var t in this._assets)e.push(t);return e})},addAsset:function(e,t){if(this.hasAsset(t)){console.error("Unable to add asset: "+t+" to AssetStore. Asset already exists.");return}if(!e){console.error("Unable to add asset: "+t+" to AssetStore. Asset cannot be undefined.");return}this._assets[t]=e},removeAllAssets:function(){for(var e in this._assets)delete this._assets[e];this._assets=new Object},getAsset:function(e){return this._assets[e]},assetType:function(e){return e.split(".").pop()},hasAsset:function(e){return this._assets[e]!=null},dispose:function(){this._disposed&&console.error("Unable to dispose object: "+this.name);console.info(this.type+": "+this.name+" is disposed");this.removeAllAssets();this._disposed=!0;this._assets=null}});rocket88.assetStore=new rocket88.AssetStore;rocket88.Matrix=Class.extend({init:function(e,t,n,r,i,s){this.a=e||1;this.b=t||0;this.c=n||0;this.d=r||1;this.tx=i||0;this.ty=s||0},identity:function(){this.a=1;this.b=0;this.c=0;this.d=1;this.tx=0;this.ty=0;return this},inverse:function(){var e=this.a*this.d-this.b*this.c,t=this.d/e,n=-1*this.b/e,r=-1*this.c/e,i=this.a/e,s=(this.c*this.ty-this.d*this.tx)/e,o=(this.b*this.tx-this.a*this.ty)/e;this.a=t;this.b=n;this.c=r;this.d=i;this.tx=s;this.ty=o;return this},multiply:function(e){var t=this.a*e.a+this.c*e.b,n=this.b*e.a+this.d*e.b,r=this.a*e.c+this.c*e.d,i=this.b*e.c+this.d*e.d,s=this.a*e.tx+this.c*e.ty+this.tx,o=this.b*e.tx+this.d*e.ty+this.ty;this.a=t;this.b=n;this.c=r;this.d=i;this.tx=s;this.ty=o;return this},translate:function(e,t){var n=new rocket88.Matrix(1,0,0,1,e,t);this.multiply(n);return this},rotate:function(e){var t=Math.sin(e),n=Math.cos(e),r=new rocket88.Matrix(n,t,-1*t,n);this.multiply(r);return this},scale:function(e,t){var n=new rocket88.Matrix(e,0,0,t);this.multiply(n);return this},clone:function(){return new rocket88.Matrix(this.a,this.b,this.c,this.d,this.tx,this.ty)},toString:function(){return"[matrix a="+this.a+" b="+this.b+" c="+this.c+" d="+this.d+" tx="+this.tx+" ty="+this.ty+"]"},toCss:function(){var e="matrix("+this.a.toFixed(12)+","+this.b.toFixed(12)+","+this.c.toFixed(12)+","+this.d.toFixed(12)+","+this.tx.toFixed(12)+","+this.ty.toFixed(12)+")",t="-moz-transform:"+e+";-webkit-transform:"+e+";-o-transform:"+e+";transform:"+e+";";return t}});var b2Vec2=b2Vec2||Box2D.Common.Math.b2Vec2;rocket88.Point=Class.extend({init:function(e,t){this.x=e||0;this.y=t||0},add:function(e){this.x+=e.x();this.y+=e.y()},substract:function(e){this.x-=e.x();this.y-=e.y()},multiply:function(e){this.x*=e;this.y*=e},distanceTo:function(e){var t=e.x()-this.x,n=e.y()-this.y;return Math.sqrt(t*t+n*n)},direction:function(){var e=point.x()-this.x,t=point.y()-this.y;return Math.atan2(t,e)},clone:function(){return new rocket88.Point(this.x,this.y)},toString:function(){return"[point x="+this.x+" y="+this.y+"]"},toCss:function(){return"left:"+this.x.toFixed(12)+";top:"+this.y.toFixed(12)+";"},toB2Vec2:function(){var e=1/30;return new b2Vec2(this.x*e,this.y*e)}});rocket88.Rectangle=Class.extend({init:function(e,t,n,r){this.origin=new rocket88.Point(e,t);this.size=new rocket88.Size(n,r);this.__defineGetter__("top",function(){return this.origin.y});this.__defineGetter__("right",function(){return this.origin.x+this.size.width});this.__defineGetter__("bottom",function(){return this.origin.y+this.size.height});this.__defineGetter__("left",function(){return this.origin.x});this.__defineGetter__("isEmpty",function(){return this.size.isEmpty})},center:function(){this.origin.x(-0.5*this.size.width());this.origin.y(-0.5*this.size.height())},contains:function(e){var t=e.x()>this.left()&&e.x()<this.right(),n=e.y()>this.top()&&e.y()<this.bottom();return t&&n},inflate:function(e){this.origin.x(this.origin.x()-e.width());this.size.width(this.size.width()+e.width()*2);this.origin.y(this.origin.y()-e.height());this.size.height(this.size.height()+e.height()*2)},deflate:function(e){this.origin.x(this.origin.x()+e.width());this.size.width(this.size.width()-e.width()*2);this.origin.y(this.origin.y()+e.height());this.size.height(this.size.height()-e.height()*2)},empty:function(){this.origin.x=0;this.origin.y=0;this.size.empty()},clone:function(){return new rocket88.Rectangle(this.origin.x,this.origin.y,this.size.width,this.size.height)},toString:function(){return"[rectangle x="+this.origin.x+" y="+this.origin.y+" width="+this.size.width+" height="+this.size.height+"]"},toCss:function(){return this.origin.toCss()+this.size.toCss()}});rocket88.Size=Class.extend({init:function(e,t){this.width=e||0;this.height=t||0;this.__defineGetter__("isEmpty",function(){return this.width==0&&this.height==0})},empty:function(){this.width=0;this.height=0},clone:function(){return new rocket88.Size(this.width,this.height)},toString:function(){return"[size width="+this.width+" height="+this.height+"]"},toCss:function(){return"width:"+this.width.toFixed(12)+";height:"+this.height.toFixed(12)+";"}});rocket88.Rotation=Class.extend({init:function(e,t){this._degrees=0;this._radians=0;this.__defineGetter__("degrees",function(){return this._degrees});this.__defineSetter__("degrees",function(e){this._degrees=e;this._radians=degreesToRadians(e)});this.__defineGetter__("radians",function(){return this._radians});this.__defineSetter__("radians",function(e){this._radians=e;this._degrees=radiansToDegrees(e)})}});rocket88.Object88=rocket88.EventDispatcher.extend({init:function(e){this._super();this._createdAt=(new Date).getTime();this._name=e||"unnamed"+Math.round(Math.random()*this._createdAt);this._ready=!1;this._disposed=!1;this.autoDispose=!0;this.tag=0;this.__defineGetter__("type",function(){return"Object88"});this.__defineGetter__("name",function(){return this._name});this.__defineGetter__("createdAt",function(){return this._createdAt});this.__defineGetter__("isReady",function(){return this._ready});this.__defineGetter__("isDisposed",function(){return this._disposed})},ready:function(){this._ready=!0;console.info(this.type+": "+this._name+" is ready");this.dispatch("ready",this)},update:function(){if(!this._ready)return},clone:function(e){var t=new Object88(e);return t},toString:function(){return"["+this.type+' name="'+this._name+'" isReady='+this._ready+" isDisposed="+this._disposed+"]"},dispose:function(){this._super();this._disposed&&console.assert(!Rocket88.showErrors,"Unable to dispose object: "+this.name);this.dispatch("disposed",this);console.info(this.type+": "+this._name+" is disposed");this._assetStore=null;this._director=null;this._name=null;this._world=null;this._disposed=!0}});rocket88.Director=Class.extend({init:function(e){if(rocket88.director)throw ReferenceError("Houston, we have a problem. Director is a singleton class. Use rocket88.director to get a reference.");console.log("This game utilises the Rocket88 engine v"+rocket88.version);if(e){this._stats=new Stats;this._stats.domElement.style.position="absolute";this._stats.domElement.style.top="0px";this._stats.domElement.style.left="0px";document.body.appendChild(this._stats.domElement)}this._accumulator=0;this._crashed=!1;this._currentScene=null;this._currentTime=(new Date).getTime();this._frame=0;this._frameTime=1e3/60;this._paused=!1;this._renderer=undefined;this.debugMode=e;this.showWarnings=e;this.showErrors=e;this.__defineGetter__("type",function(){return"Rocket88"});this.__defineGetter__("crashed",function(){return this._crashed});this.__defineGetter__("renderer",function(){return this._renderer});this.__defineSetter__("renderer",function(e){this._renderer&&console.assert(!this.showErrors,"Renderer already added");this._renderer=e});this.__defineGetter__("scene",function(){return this._currentScene});this.__defineSetter__("scene",function(e){this._currentScene&&this._currentScene.autoDestroy&&this._currentScene.destroy();this._currentScene=e})},updateWithFixedTimestep:function(){if(!this._paused&&!this._crashed){requestAnimationFrame(delegate(this,this.updateWithFixedTimestep));var e=(new Date).getTime(),t=e-this._currentTime;this._accumulator+=t;this._currentTime=e;while(this._accumulator>=this._frameTime){this._accumulator-=this._frameTime;this.update()}}},update:function(){this._frame++;this._renderer.prepare();this._currentScene.update();this._renderer.camera=this._currentScene.camera;this._renderer.finish();this._stats&&this._stats.update()},liftOff:function(){if(!this._currentScene)throw ReferenceError("Houston, we have a problem. Required argument 'scene' is missing");if(!this._renderer)throw ReferenceError("Houston, we have a problem. Required argument 'renderer' is missing");this._currentScene.ready();this._renderer.ready();console.info("Houston, we have a lift off!");this._paused=!1;this.updateWithFixedTimestep();return!0},land:function(){this._paused=!0},crash:function(){if(this._crashed)throw ReferenceError("Houston, we have a problem. Unable to crash Rocket88 game");console.info("Houston, Rocket88 crashed to the ground");this._currentScene.dispose();AssetStore.getInstance().dispose();AssetLoader.getInstance().dispose();this._currentScene=null;this._currentTime=0;this._frame=0;this._paused=!1;this._renderer=null;this._crashed=!0;return!0},toString:function(){return"["+this.type+" running="+!this._paused+" crashed="+this._crashed+"]"}});rocket88.director=new rocket88.Director(!0);rocket88.Renderer=Class.extend({init:function(e){if(e==undefined)throw ReferenceError("Required parameter 'target' is missing");this._target=e;this._transformMatrix=new rocket88.Matrix;this._cameraMatrix=new rocket88.Matrix;this._camera=undefined;this._renderedGameObject=undefined;this._renderedLayer=undefined;this.backgroundColor=undefined;this.__defineGetter__("target",function(){return this._target});this.__defineGetter__("transformMatrix",function(){return this._transformMatrix});this.__defineGetter__("type",function(){return"renderer"});this.__defineSetter__("camera",function(e){this._camera=e;this._cameraMatrix.identity();this._cameraMatrix.tx=-1*e.position.x;this._cameraMatrix.ty=-1*e.position.y});this.__defineSetter__("renderedLayer",function(e){this._renderedLayer=e});this.__defineSetter__("renderedGameObject",function(e){this._renderedGameObject=e})},ready:function(){},prepare:function(){},draw:function(e){this.calculateTransformation(e)},finish:function(){},calculateTransformation:function(e){this._transformMatrix.identity();this._transformMatrix.multiply(this._cameraMatrix);this._transformMatrix.multiply(this._renderedGameObject.transform.matrix);this._transformMatrix.multiply(e.transform.matrix);return this._transformMatrix},dispose:function(){this._super();this._cameraMatrix=null;this._origin=null;this._target=null;this._transformMatrix=null}});var b2Vec2=b2Vec2||Box2D.Common.Math.b2Vec2,b2World=b2World||Box2D.Dynamics.b2World;rocket88.Scene=rocket88.Object88.extend({init:function(e){this._super(e);this._layers=new rocket88.LinkedList;this._layersByName=new Object;this._gravity=30;var t=new b2Vec2(0,this._gravity);this._world=new b2World(t,!0);this._collisionSolver=new rocket88.CollisionSolver;this._world.SetContactListener(this._collisionSolver.listener);this.camera=new rocket88.Camera;this.__defineGetter__("type",function(){return"scene"});this.__defineGetter__("layers",function(){return this._layers.toArray()});this.__defineGetter__("world",function(){return this._world});this.__defineGetter__("gravity",function(){return this._layers.toArray()});this.__defineGetter__("gravity",function(e){return this._gravity})},ready:function(){this._super();var e=this._layers.head;while(e){var t=e.data;t.ready();e=e.next}},update:function(){this._super();this._collisionSolver.prepare();this._world.Step(1/60,10,10);this._world.DrawDebugData();this._world.ClearForces();this._collisionSolver.finish();rocket88.director.debugMode&&this._world.DrawDebugData();this.camera.update();var e=this._layers.head;while(e){var t=e.data;t.update();e=e.next}},addLayer:function(e){if(e.isDisposed){console.assert(!this.director.showErrors,"Unable to add disposed layer: "+e.name+" to scene: "+this.name);return null}if(this.hasLayer(e.name)){console.assert(!this.director.showErrors,"Unable to add layer: "+e.name+" to scene: "+this.name+" Required property 'name' must be unique");return null}e.scene=this;this.isReady&&e.ready();this._layers.add(e);this._layersByName[e.name]=e;this.onLayerAdded(e);return e},addLayerAbove:function(e,t){if(this.hasLayer(t.name)){console.assert(!this.director.showErrors,"Unable to add layer: "+e.name+" above layer: "+t.name+" The latter doesn't exists in scene: "+this.name);return!1}e.scene=this;this.isReady&&e.ready();this._layers.insertAfter(e,myNode);this._layersByName[e.name]=e;this.onLayerAdded(layer);return!0},addLayerBelow:function(e,t){if(this.hasLayer(t.name)){console.assert(!this.director.showErrors,"Unable to add layer: "+e.name+" below layer: "+t.name+" The latter doesn't exists in scene: "+this.name);return!1}e.scene=this;this.isReady&&e.ready();this._layers.insertBefore(e,myNode);this._layersByName[e.name]=e;this.onLayerAdded(layer);return!0},onLayerAdded:function(e){},swapLayers:function(e,t){if(!this.hasLayer(e.name)||!this.hasLayer(t.name)){console.assert(!this.director.showErrors,"Unable to swap layer: "+e.name+" with layer:"+t.name);return!1}var n=this._layers.nodeOf(e),r=this._layers.nodeOf(t);this._layers.swap(n,r);return!0},removeLayer:function(e){if(!this.hasLayer(e.name)){console.assert(!this.director.showErrors,"Unable to remove layer: "+e.name+" from scene: "+this.name+" Layer doesn't exists in scene: "+this.name);return null}this._layers.nodeOf(e).remove();delete this._layersByName[e.name];e.autoDispose&&e.dispose();this.onLayerRemoved(e);return e},removeAllLayers:function(e){var t=this._layers.head;while(t){var n=t.data;this.onLayerRemoved(n);n.autoDispose&&n.dispose();var r=t.next;this._layers.remove(t);t=r}this._layersByName=new Object},onLayerRemoved:function(e){},getLayerByName:function(e){return this._layersByName[e]},getLayerByTag:function(e){var t=this._layers.head;while(t){var n=t.data;if(n.tag!=0&&n.tag==e)return n;t=t.next}return undefined},hasLayer:function(e){return this._layersByName[e]!=null},clone:function(e){var t=new Scene;t.camera=this.camera.clone();var n=this.layers.length;while(--n>-1){var r=this.layers[n].clone();t.addLayer(r)}return t},dispose:function(){this._super();this._collisionSolver.dispose();this.removeAllLayers();_world.SetDestructionListener(new b2DestructionListener);this._collisionSolver=null;this._camera=null;this._layers=null;this._layersByName=null;this._world=null}});rocket88.Layer=rocket88.Object88.extend({init:function(e){this._super(e);this._gameObjects=new rocket88.LinkedList;this._gameObjectsByName=new Object;this.z=0;this.scene=undefined;this.__defineGetter__("type",function(){return"layer"});this.__defineGetter__("gameObjects",function(){return this._gameObject.toArray()})},ready:function(){this._super();var e=this._gameObjects.head;while(e){var t=e.data;t.ready();e=e.nextdata}},update:function(){this._super();var e=rocket88.director.renderer;e.renderedLayer=this;var t=this._gameObjects.head;while(t){var n=t.data;n.update();t=t.next}},addGameObject:function(e){if(e.isDisposed){console.assert(!this.director.showErrors,"Unable to add disposed gameobject: "+e.name+" to layer: "+this.name);return null}if(this.hasGameObject(e.name)){console.assert(!this.director.showErrors,"Unable to add gameobject: "+e.name+" to scene: "+this.name+" Required property 'name' must be unique");return null}e.layer=this;this.isReady&&e.ready();this._gameObjects.add(e);this._gameObjectsByName[e.name]=e;this.onGameObjectAdded(e);return e},addGameObjectAbove:function(e,t){if(this.hasGameObject(t.name)){console.assert(!this.director.showErrors,"Unable to add gameobject: "+e.name+" above gameobject: "+t.name+" The latter doesn't exists in layer: "+this.name);return!1}e.scene=this;this.isReady&&e.ready();this._gameObjects.insertAfter(e,myNode);this._gameObjectsByName[e.name]=e;this.onGameObjectAdded(gameobject);return!0},addGameObjectBelow:function(e,t){if(this.hasgameObject(t.name)){console.assert(!this.director.showErrors,"Unable to add gameobject: "+e.name+" below gameobject: "+t.name+" The latter doesn't exists in layer: "+this.name);return!1}e.scene=this;this.isReady&&e.ready();this._gameObjects.insertBefore(e,myNode);this._gameObjectsByName[e.name]=e;this.onGameObjectAdded(gameobject);return!0},onGameObjectAdded:function(e){},swapGameObjects:function(e,t){if(!this.hasGameObject(e.name)||!this.hasGameObject(t.name)){console.assert(!this.director.showErrors,"Unable to swap gameobject: "+e.name+" with gameobject:"+t.name);return!1}var n=this._gameObjects.nodeOf(e),r=this._gameObjects.nodeOf(t);this._gameObjects.swap(n,r);return!0},removeGameObject:function(e){if(!this.hasGameObject(e.name)){console.assert(!this.director.showErrors,"Unable to remove gameobject: "+e.name+" from scene: "+this.name+" gameobject doesn't exists in layer: "+this.name);return null}this._gameObjects.nodeOf(e).remove();delete this._gameObjectsByName[e.name];e.autoDispose&&e.dispose();this.onGameObjectRemoved(e);return e},removeAllGameObjects:function(e){var t=this._gameObjects.head;while(t){var n=t.data;this.onGameObjectRemoved(n);n.autoDispose&&n.dispose();var r=t.next;this._gameObjects.remove(t);t=r}this._gameObjectsByName=new Object},onGameObjectRemoved:function(e){},getGameObjectByName:function(e){return this._gameObjectsByName[e]},getGameObjectByTag:function(e){var t=this._gameObjects.head;while(t){var n=t.data;if(n.tag!=0&&n.tag==e)return n;t=t.next}return undefined},hasGameObject:function(e){return this._gameObjectsByName[e]!=null},clone:function(e){var t=new Layer(e);t.depth=this.depth;var n=this.gameobjects.length;while(--n>-1){var r=this._gameObjects[n].clone();t.addGameObject(r)}return t},dispose:function(){this._super();this.removeAllGameObjects();this._gameObjects=null;this._gameObjectsByName=null;this._renderer=null}});rocket88.GameObject=rocket88.Object88.extend({init:function(e){this._super(e);this._components=new rocket88.LinkedList;this._componentsByName=new Object;this._transform=new rocket88.TransformComponent;this._transform.gameobject=this;this._graphic=new rocket88.GraphicComponent;this._graphic.gameobject=this;this.layer=undefined;this.group=0;this.__defineGetter__("type",function(){return"gameobject"});this.__defineGetter__("components",function(){return this._components.toArray()});this.__defineGetter__("transform",function(){return this._transform});this.__defineGetter__("graphic",function(){return this._graphic})},ready:function(){this._super();var e=this._components.head;while(e){var t=e.data;t.ready();e=e.next}this._transform.ready();this._graphic.ready()},update:function(){this._super();var e=rocket88.director.renderer;e.renderedGameObject=this;var t=this._components.head;while(t){var n=t.data;n.enabled&&n.update();t=t.next}this._transform.update();this._graphic.update()},addComponent:function(e){if(e.isDisposed){console.assert(!this.director.showErrors,"Unable to add disposed component: "+e.name+" to gameobject: "+this.name);return null}if(this.hasComponent(e.name)){console.assert(!this.director.showErrors,"Unable to add component: "+e.name+" to gameobject: "+this.name+" Required property 'name' must be unique");return null}e.gameobject=this;this.isReady&&e.ready();this._components.add(e);this._componentsByName[e.name]=e;this.onComponentAdded(e);return e},onComponentAdded:function(e){},removeComponent:function(e){if(!this.hasComponent(e.name))return!1;this._objectList.nodeOf(e).remove();delete this._objectSet[e.name];myComponent.autoDispose&&myComponent.dispose();this.onComponentRemoved(e);return myObject},removeAllComponents:function(){var e=this._components.head;while(e){var t=e.data;this.onComponentRemoved(t);t.autoDispose&&t.dispose();e=e.next}this._components=new LinkedList;this._componentsByName=new Object},onComponentRemoved:function(e){},hasComponent:function(e){return this._componentsByName[e]!=null},getComponentByName:function(e){return this._componentsByName[e]},getComponentByTag:function(e){var t=this._layers.head;while(t){var n=t.data;if(n.tag!=0&&n.tag==e)return n;t=t.next}return undefined},clone:function(e){var t=new Layer(e),n=this._components.length;while(--n>-1){var r=this._components[n].clone();t.addComponent(r)}return t},dispose:function(){this._super();this._graphic.dispose();this._transform.dispose();this.removeAllComponents();this._components=null;this._componentsByName=null;this._graphic=null;this._transform=null;this._renderer=null;this.layer=null}});rocket88.Component=rocket88.Object88.extend({init:function(e){this._super(e);this._enabled=!0;this.gameobject=undefined;this.__defineGetter__("type",function(){return"component"});this.__defineGetter__("enabled",function(){return this._enabled})},ready:function(){this._super()},enable:function(){this._enabled=!0},disable:function(){this._enabled=!1},dispose:function(){this._super();this.gameObject=null}});rocket88.Camera=rocket88.Object88.extend({init:function(e){this._super(e);this._position=new rocket88.TransformComponent;this.isStatic=!0;this.focalLength=80;this.viewport=new rocket88.Rectangle;this.__defineGetter__("type",function(){return"camera"});this.__defineGetter__("position",function(){return this._position})},clone:function(e){var t=new Camera(e);t.isStatic=this.isStatic;t.focalLength=this.focalLength;t.viewport=this.viewport.clone();return t},dispose:function(){this._super();this.transform=null;this.viewport=null}});var b2ContactListener=b2ContactListener||Box2D.Dynamics.b2ContactListener,b2WorldManifold=b2WorldManifold||Box2D.Collision.b2WorldManifold;rocket88.CollisionSolver=Class.extend({init:function(){this._collisions=null;this._listener=new b2ContactListener;this._listener.BeginContact=delegate(this,this.beginContact);this._listener.EndContact=delegate(this,this.endContact);this._listener.PreSolve=delegate(this,this.preSolve);this._listener.PostSolve=delegate(this,this.postSolve);this.__defineGetter__("listener",function(){return this._listener})},prepare:function(){this._collisions=new Object},beginContact:function(e){var t=this.getContactName(e),n=this._collisions[t];if(n==undefined){var r=e.GetFixtureA().GetUserData(),i=e.GetFixtureB().GetUserData();n=[r,i];this._collisions[t]=n;r.collisions.enabled&&r.collisions.beginContact(i);i.collisions.enabled&&i.collisions.beginContact(r)}},endContact:function(e){var t=e.GetFixtureA().GetUserData(),n=e.GetFixtureB().GetUserData();t.collisions.enabled&&t.collisions.endContact(n);n.collisions.enabled&&n.collisions.endContact(t)},preSolve:function(e,t){var n=this.getContactName(e),r=this._collisions[n];if(r){var t=new b2WorldManifold;e.GetWorldManifold(t);var i=t.m_points[0];r.position=new rocket88.Point(i.x*30,i.y*30)}},postSolve:function(e,t){var n=this.getContactName(e),r=this._collisions[n];r&&(r.impact=t.normalImpulses[0])},finish:function(){for(var e in this._collisions){var t=this._collisions[e],n=t[0],r=t[1];n.collisions.enabled&&n.collisions.onCollision(r,t.position,t.impact);r.collisions.enabled&&r.collisions.onCollision(n,t.position,t.impact)}this._collisions=null},getContactName:function(e){var t=e.GetFixtureA().GetUserData(),n=e.GetFixtureB().GetUserData();return t.name+".vs."+n.name},dispose:function(){this._collisions=null;this._listener=null}});var b2DebugDraw=Box2D.Dynamics.b2DebugDraw;rocket88.CanvasRenderer=rocket88.Renderer.extend({init:function(e){this._super(e);if(e.tagName.toLowerCase()!="canvas")throw ReferenceError("Required property 'target' must be a canvas object");this._context=e.getContext("2d");this.__defineGetter__("context",function(){return this._context})},ready:function(){this._super();if(rocket88.director.debugMode){this.backgroundColor="#cccccc";var e=new b2DebugDraw;e.SetSprite(this._context);e.SetDrawScale(30);e.SetFillAlpha(1);e.SetLineThickness(1);e.SetFlags(b2DebugDraw.e_shapeBit|b2DebugDraw.e_jointBit);rocket88.director.scene.world.SetDebugDraw(e)}},prepare:function(){this._super();if(this.backgroundColor){this._context.fillStyle="#cccccc";this._context.fillRect(0,0,this._target.width,this._target.height)}else this._context.clearRect(0,0,this._target.width,this._target.height)},draw:function(e){this._super(e);if(!rocket88.assetStore.hasAsset(e.url)){console.assert(!myDirector.showErrors,"Unable to find sprite:"+e.url+" at the AssetStore");return}this._context.save();var t=e.cropRect.size.width,n=e.cropRect.size.height,r=-t>>1,i=-n>>1;this._context.transform(this.transformMatrix.a,this.transformMatrix.b,this.transformMatrix.c,this.transformMatrix.d,this.transformMatrix.tx,this.transformMatrix.ty);this._context.globalAlpha=e.alpha;var s=rocket88.assetStore.getAsset(e.url);this._context.drawImage(s,e.cropRect.origin.x,e.cropRect.origin.y,t,n,r,i,t,n);this._context.restore()}});rocket88.HTMLRenderer=rocket88.Renderer.extend({init:function(e){this._super(e);if(e.tagName.toLowerCase()!="div")throw new ReferenceError("Required property 'target' must be a div object")},prepare:function(){this._target.style.position="relative";this._htmlString=""},draw:function(e){this._super(e);var t=e.cropRect.size.width,n=e.cropRect.size.height,r=-t>>1,i=-n>>1,s="";s+="position:absolute;";s+="left:"+r+"px;top:"+i+"px;";s+="width:"+t+"px;height:"+n+"px;";s+="background-image:url("+e.url+");";s+="background-position:"+ -1*e.cropRect.origin.x+"px "+ -1*e.cropRect.origin.y+"px;";s+=this.transformMatrix.toCss();s+=e.toCss();this._htmlString+="<div id="+this._renderedGameObject.name+" style='"+s+"'></div>"},finish:function(){this.target.innerHTML=this._htmlString}});rocket88.PhysicsObject=rocket88.GameObject.extend({init:function(e){this._super(e);this._reusableVector=new b2Vec2;this._physics=new rocket88.PhysicsComponent;this._physics.gameobject=this;this._collisions=new rocket88.CollisionComponent;this._collisions.gameobject=this;this._joints=new rocket88.JointsComponent;this._joints.gameobject=this;this.__defineGetter__("physics",function(){return this._physics});this.__defineGetter__("collisions",function(){return this._collisions});this.__defineGetter__("joints",function(){return this._joints});this.transform.onTransform=
delegate(this,this.onTransform);this.collisions.onCollision=delegate(this,this.onCollision)},ready:function(){this._super();this._physics.ready();this._collisions.ready()},update:function(){this._super();var e=this._physics.body.GetPosition();this._transform.position.x=e.x*30;this._transform.position.y=e.y*30;this._transform.rotation.radians=this._physics.body.GetAngle()},onTransform:function(e,t,n){var r=1/30;this._reusableVector.x=this.transform.position.x*r;this._reusableVector.y=this.transform.position.y*r;var i=this.transform.rotation.radians;this._physics.body.SetPositionAndAngle(this._reusableVector,i)},onCollision:function(e,t,n){},dispose:function(){this._super();this._physics.dispose();this._collisions.dispose();this._physics=null;this._collisions=null}});rocket88.InteractiveObject=rocket88.PhysicsObject.extend({init:function(e){this._super(e);this._keys=new rocket88.KeysComponent;this.addComponent(this._keys);this.__defineGetter__("keys",function(){return this._keys});this.keys.onKeyDown=delegate(this,this.onKeyDown);this.keys.onKeyUp=delegate(this,this.onKeyUp)},onKeyDown:function(e){},onKeyUp:function(e){},dispose:function(){this._super();this._keys=null}});rocket88.TransformComponent=rocket88.Component.extend({init:function(){this._super("transform");this.origin=new rocket88.Point(0,0);this.scaleX=0;this.scaleY=0;this._scale=1;this._flippedX=!1;this._flippedY=!1;this._position=new rocket88.Point;this._rotation=new rocket88.Rotation;this._matrix=new rocket88.Matrix;this.__defineGetter__("degrees",function(){return this._rotation.degrees});this.__defineSetter__("degrees",function(e){var t=this._rotation;this._rotation.degrees=e;this.onTransform("rotation",this._rotation,t)});this.__defineGetter__("radians",function(){return this._rotation.radians});this.__defineSetter__("radians",function(e){var t=this._rotation;this._rotation.radians=e;this.onTransform("rotation",this._rotation,t)});this.__defineGetter__("x",function(){return this._position.x});this.__defineSetter__("x",function(e){var t=this._position.x;this._position.x=e;this.onTransform("position",this._position,t)});this.__defineGetter__("y",function(){return this._position.y});this.__defineSetter__("y",function(e){var t=this._position.y;this._position.y=e;this.onTransform("position",this._position,t)});this.__defineGetter__("scale",function(){return this._scale});this.__defineSetter__("scale",function(e){this._scale=e;this.scaleX=e;this.scaleY=e});this.__defineGetter__("position",function(){return this._position});this.__defineGetter__("rotation",function(){return this._rotation});this.__defineGetter__("matrix",function(){var e=this._flippedX?-1:1,t=this._flippedY?-1:1;this._matrix.identity();this._matrix.translate(this._position.x,this._position.y);this._matrix.rotate(this._rotation.radians);this._matrix.scale(this.scaleX,this.scaleY);this._matrix.scale(e,t);this._matrix.translate(-1*this.origin.x,-1*this.origin.y);return this._matrix})},flipX:function(e){this._flippedX=!this._flippedX;e!=undefined&&(this._flippedX=e)},flipY:function(e){this._flippedY=!this._flippedY;e!=undefined&&(this._flippedY=e)},onTransform:function(e,t,n){}});rocket88.GraphicComponent=rocket88.Component.extend({init:function(){this._super("graphic");this._sprite=undefined;this.__defineGetter__("renderer",function(){return this._renderer});this.__defineGetter__("sprite",function(){return this._sprite});this.__defineSetter__("sprite",function(e){if(this._sprite){console.warn("Replacing sprite: "+this._sprite.name+" with sprite: "+e.name);this._sprite.autoDispose&&this._sprite.dispose()}this._sprite=e})},update:function(){this._super();if(this._sprite){this._sprite.update();rocket88.director.renderer.draw(this._sprite)}},dispose:function(){this._super();this._sprite.dispose();this._sprite=null}});var b2Vec2=b2Vec2||Box2D.Common.Math.b2Vec2,b2FixtureDef=b2FixtureDef||Box2D.Dynamics.b2FixtureDef,b2PolygonShape=b2PolygonShape||Box2D.Collision.Shapes.b2PolygonShape,b2CircleShape=b2CircleShape||Box2D.Collision.Shapes.b2CircleShape,b2Body=b2Body||Box2D.Dynamics.b2Body,b2BodyDef=b2BodyDef||Box2D.Dynamics.b2BodyDef;rocket88.PhysicsComponent=rocket88.Component.extend({init:function(){this._super("physics");this._body=undefined;this._reusableVector=new b2Vec2;this._damping=.35;this._density=1;this._friction=.5;this._restitution=.35;this.isPlatform=!1;this.__defineGetter__("body",function(){return this._body});this.__defineGetter__("isStatic",function(){return this.body.GetType()==b2Body.b2_staticBody});this.__defineSetter__("isStatic",function(e){this.setType(e?"static":"dynamic")});this.__defineGetter__("isKinematic",function(){return this.body.GetType()==b2Body.b2_kinematicBody});this.__defineSetter__("isKinematic",function(e){this.isReady&&this._body.setType(e?"kinematic":"dynamic")});this.__defineGetter__("isBullet",function(){return this.body.IsBullet()});this.__defineSetter__("isBullet",function(e){this.isReady&&this._body.SetBullet(e)});this.__defineGetter__("isFixedRotation",function(){return this.body.IsFixedRotation()});this.__defineSetter__("isFixedRotation",function(e){this.isReady&&this._body.SetFixedRotation(e)});this.__defineGetter__("isTrigger",function(){return this.body.GetFixtureList().IsSensor()});this.__defineSetter__("isTrigger",function(e){this.isReady&&this._body.GetFixtureList().SetSensor(e)})},ready:function(){this._super();var e=new b2BodyDef;e.userData=this.gameobject;e.bullet=!1;e.fixedRotation=!1;var t=1/30;e.position.x=this.gameobject.transform.position.x*t;e.position.y=this.gameobject.transform.position.y*t;e.angle=this.gameobject.transform.rotation.radians;e.angularDamping=this._damping;e.linearDamping=this._damping;e.type=b2Body.b2_dynamicBody;this._body=rocket88.director.scene.world.CreateBody(e)},addCircle:function(e){var t=1/30,n=e*t,r=new b2CircleShape(e*t);this.createFixture(r)},addBox:function(e){var t=1/30,n=e.width>>1,r=e.height>>1,i=new b2PolygonShape;i.SetAsBox(n*t,r*t);this.createFixture(i)},addPolygon:function(){},createFixture:function(e){var t=new b2FixtureDef;t.userData=this.gameobject;t.shape=e;t.density=this._density;t.friction=this._friction;t.restitution=this._restitution;t.isSensor=this._isTrigger;this._body.CreateFixture(t)},setType:function(e){var t=e=="kinematic",n=e=="static";this._body.SetType(b2Body.b2_dynamicBody);t?this._body.SetType(b2Body.b2_kinematicBody):n&&this._body.SetType(b2Body.b2_staticBody)},applyForce:function(e,t){if(this.isReady){this._reusableVector.x=e;this._reusableVector.y=t;this._body.ApplyForce(this._reusableVector,this._body.GetPosition())}},applyImpulse:function(e,t){if(this.isReady){this._reusableVector.x=e;this._reusableVector.y=t;this._body.ApplyImpulse(this._reusableVector,this._body.GetPosition())}},applyTorque:function(e){this.isReady&&this._body.ApplyTorque(e)},dispose:function(){this._super()}});rocket88.CollisionComponent=rocket88.Component.extend({init:function(){this._super("collision");this._contacts="";this._groups=0},beginContact:function(e){this._contacts+="|"+e.name;this._groups|=e.group},endContact:function(e){this._contacts=this._contacts.replace("|"+e.name,"");this._groups&=~e.group},onCollision:function(e,t,n){},touches:function(e){return this._contacts.indexOf(e)>-1},touchesGroup:function(e){return this._groups&e},dispose:function(){this._super();this._contacts=null}});rocket88.JointsComponent=rocket88.Component.extend({});rocket88.KeysComponent=rocket88.Component.extend({init:function(){this._super("keys");this.pressedKeys="";document.onkeydown=delegate(this,function(e){if(this.enabled){var t=e.keyCode;if(!this.keyIsDown(t)){this.pressedKeys+="|"+t;this.onKeyDown(t);switch(t){case 37:this.onLeftArrow("down");break;case 39:this.onRightArrow("down");break;case 37:this.onUpArrow("down");break;case 40:this.onDownArrow("down");break;case 32:this.onSpacebar("down")}}}});document.onkeyup=delegate(this,function(e){if(this.enabled){var t=e.keyCode;if(this.keyIsDown(t)){this.pressedKeys=this.pressedKeys.replace("|"+t,"");if(this.enabled){this.onKeyUp(e.keyCode);switch(e.keyCode){case 37:this.onLeftArrow("up");break;case 39:this.onRightArrow("up");break;case 37:this.onUpArrow("up");break;case 40:this.onDownArrow("up");break;case 32:this.onSpacebar("up")}}}}})},keyIsDown:function(e){return this.pressedKeys.indexOf("|"+e)>-1},onKeyDown:function(e){},onKeyUp:function(e){},onLeftArrow:function(e){},onRightArrow:function(e){},onUpArrow:function(e){},onDownArrow:function(e){},onSpacebar:function(e){}});rocket88.Sprite=Class.extend({init:function(e,t){if(!e){console.assert(!Rocket88.showErrors,"Required argument 'url' is missing");return}this._currentFrame=undefined;this._disposed=!1;this._spritesheet=t;this._url=e;this._size=new rocket88.Size;this._transform=new rocket88.TransformComponent;this.cropRect=undefined;this.className=undefined;this.alpha=1;this.tiled=!1;this.__defineGetter__("currentFrame",function(){return this._currentFrame});this.__defineGetter__("disposed",function(){return this._disposed});this.__defineGetter__("spritesheet",function(){return this._spritesheet});this.__defineGetter__("size",function(){return this._size});this.__defineGetter__("transform",function(){return this._transform});this.__defineGetter__("url",function(){return this._url});if(this._spritesheet){this._size=this._spritesheet.firstFrame.size.clone();this.cropRect=this._spritesheet.firstFrame.clone()}},update:function(){},showFrame:function(e){!this._spritesheet&&Rocket88.showWarnings&&console.error("Unable to set frame on sprite: "+this._url+" Sprite doesn't have spritesheet");var t=this._spritesheet.frameByName(e);this.cropRect=t.clone()},toCss:function(){return"-moz-opacity:"+this.alpha+";-webkit-opacity:"+this.alpha+";-o-opacity:"+this.alpha+";opacity:"+this.alpha+";"},dispose:function(){this._disposed&&Rocket88.showErrors&&console.error("Unable to dispose object: "+this.name);console.info("sprite: "+this._url+" is disposed");this._disposed=!0;this._url=null;this._size=null;this._spritesheet=null;this._transform=null;this.className=null;this.cropRect=null}});rocket88.AnimatedSprite=rocket88.Sprite.extend({init:function(e,t){this._super(e,t);if(!t){console.assert(!Rocket88.showErrors,"Required argument 'spritesheet' is missing");return}this._super(e,t);this._framerate=60;this._accumulator=1;this._tick=0;this._currentAnimationName=undefined;this._currentAnimation=undefined;this._running=!1;this._stopAtTheEndOfCurrentAnimation=!1;this.loop=!0;this.reverse=!1;this.__defineGetter__("currentAnimation",function(){return this._currentAnimation});this.__defineGetter__("isRunning",function(){return this._running});this.__defineGetter__("framerate",function(){return this._framerate});this.__defineSetter__("framerate",function(e){this._framerate=e;this._accumulator=60/e})},update:function(){function t(){e._currentFrame.next?e._currentFrame=e._currentFrame.next:this._stopAtTheEndOfCurrentAnimation?e.stop():e.loop&&(e._currentFrame=e._currentAnimation.head)}function n(){e._currentFrame.prev?e._currentFrame=e._currentFrame.prev:e.loop&&(e._currentFrame=e._currentAnimation.tail)}this._super();var e=this;if(this._running&&this._spritesheet){this._tick++;if(this._tick>=this._accumulator){this._tick=0;this._reversed?n():this._stopAtTheEndOfCurrentAnimation?e.stop():t();this.showFrame(this._currentFrame.data)}}},play:function(e){if(this._currentAnimationName==e)return this;this._running=!0;this._stopAtTheEndOfCurrentAnimation=!1;this._currentAnimationName=e;this._currentAnimation=this.spritesheet.animationByName(e);this._reversed?this._currentFrame=this._currentAnimation.tail:this._currentFrame=this._currentAnimation.head;this.showFrame(this._currentFrame.data);return this},stop:function(){this._running=!1;this._stopAtTheEndOfCurrentAnimation=!1;if(this._currentAnimation){this._currentFrame=this._currentAnimation.head;this.showFrame(this._currentFrame.data)}this._currentAnimationName=undefined;this._currentAnimation=undefined;return this},stopAtTheEndOfCurrentAnimation:function(){this._stopAtTheEndOfCurrentAnimation=!0},dispose:function(){this._super();this._currentAnimation=null}});rocket88.Spritesheet=Class.extend({init:function(e){function n(){for(var t in e.frames){var n=e.frames[t].frame,i=new rocket88.Rectangle(n.x,n.y,n.w,n.h);r(t,i)}}function r(e,n){t._frames[e]=n;t._firstFrame||(t._firstFrame=n);var r=/(-|_)*(\d+)(\.[a-zA-Z]{3,4})$/,i=e.replace(r,"");t._animations[i]||(t._animations[i]=new rocket88.LinkedList);t._animations[i].add(e)}if(!e){console.assert(!Rocket88.showErrors,"Required argument 'data' is missing");return}this._rawData=e;this._disposed=!1;this._firstFrame=undefined;this._animations=new Object;this._frames=new Object;this.__defineGetter__("isDisposed",function(){return this._disposed});this.__defineGetter__("rawData",function(){return this._rawData});this.__defineGetter__("frames",function(){return this._frames});this.__defineGetter__("firstFrame",function(){return this._firstFrame});this.__defineGetter__("animations",function(){var e=new Array;for(var t in this._animations)e.push(t);return e});var t=this;n()},hasAnimation:function(e){return this._animations[e]!=null},animationByName:function(e){return this._animations[e]},hasFrame:function(e){return this._frames[e]!=null},frameByName:function(e){return this._frames[e]},dispose:function(){this._disposed&&Rocket88.showErrors&&console.error("Unable to dispose object: "+this.name);console.info(this.type+": "+this._name+" is disposed");this._rawData=null;this._firstFrame=null;this._animations=null;this._frames=null}});rocket88.ChaseCamera=rocket88.Camera.extend({init:function(e){if(e==undefined)throw ReferenceError("Required parameter 'target' is missing");this._super("chase.camera");this.isStatic=!1;this.damping=1;this.target=e},update:function(){this._super();var e=this.target.transform.x,t=this.target.transform.y;if(e>this.x+this.viewport.right){e-=_roamingArea.right;this._position.x+=(e-this.position.x)*this.damping}else if(e<this.position.x+this.viewport.left){e-=this.viewport.left;this._position.x+=(e-this.position.x)*this.damping}if(t>this.position.y+this._viewport.bottom){t-=this.viewport.bottom;this.position.y+=(t-this.position.y)*this.damping}else if(t<this.position.y+this.viewport.top){t-=this.viewport.top;this.position.y+=(t-this.position.y)*this.damping}},damping:function(e){if(damping){this._damping=e;return this}return this._damping},target:function(e){if(e){this._target=e;return this}return this._target},dispose:function(){this._super();this._target=null}});